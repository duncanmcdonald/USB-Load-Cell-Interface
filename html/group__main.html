<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>USB Load Cell Interface: Main program loop</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">USB Load Cell Interface
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__main.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Main program loop</div>  </div>
</div><!--header-->
<div class="contents">

<p>Main program loop.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__main.html#ga840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="separator:ga840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Main program loop. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga840291bc02cba5474a4cb46a9b9566fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<ul>
<li>If our reset was caused by the watchdog, go to the watchdog application</li>
<li>Impose a delay at startup - reuse the global_state_poweronticks variable (just need to make sure it is reset to 0 when done). This is kept here to enable debugging by uncommenting it. Slows down the startup sequence. !</li>
<li>Config IO Ports</li>
<li>Initialize analog circuitry at startup. Note that this was added for experimentation. For some reason, it doesn't mess things up if analog circuitry is turned on here, but if done any time post startup, it causes a USB disconnect and re-enumerate. Comment out this line to see it. There must be some transients in analog initialization that cause the host controller to freak out. !</li>
<li>Only do "dangerous" things after power-on state is stable </li>
</ul>

<p>Definition at line <a class="el" href="appusbsensormain_8c_source.html#l00791">791</a> of file <a class="el" href="appusbsensormain_8c_source.html">appusbsensormain.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__main_ga840291bc02cba5474a4cb46a9b9566fe_cgraph.png" border="0" usemap="#group__main_ga840291bc02cba5474a4cb46a9b9566fe_cgraph" alt=""/></div>
<map name="group__main_ga840291bc02cba5474a4cb46a9b9566fe_cgraph" id="group__main_ga840291bc02cba5474a4cb46a9b9566fe_cgraph">
<area shape="rect" id="node2" href="group__std__request.html#ga8fd55460e1cb09b83e99cd403fd5eeb8" title="Initializes the usb stack in device mode. " alt="" coords="109,5,258,32"/><area shape="rect" id="node3" href="group__adc__initialize.html#ga00b878f951ed02d5a94f1d46196494c3" title="adc_initialize" alt="" coords="135,56,232,83"/><area shape="rect" id="node8" href="group__timer.html#ga5d73e479d2a7821caaa53056a52304ce" title="start timer " alt="" coords="131,173,236,200"/><area shape="rect" id="node10" href="group__teds__management.html#ga2433c7d94c56f678f8621bc3537bfcd3" title="Called by the main event loop. If TEDS is not ready or the connect state changed, then re&#45;read..." alt="" coords="122,224,245,251"/><area shape="rect" id="node22" href="group__power.html#ga200af95bce5d421e0753b1834294d6bf" title="appusbsensor_poweron\l_stable" alt="" coords="104,107,263,149"/><area shape="rect" id="node23" href="group__std__request.html#ga86bea8cf48b972656c17d6e13a3c2df5" title="Called in a loop to service the usb stack. " alt="" coords="119,663,248,689"/><area shape="rect" id="node49" href="group__hid.html#ga67aeec757a5e476ae6dcacd725bd1764" title="service_hid_interrupt\l_endpoint" alt="" coords="113,743,253,785"/><area shape="rect" id="node4" href="serial__debug_8c.html#abea31d0480994d1bd08086a483445501" title="debug_write_string" alt="" coords="334,73,465,100"/><area shape="rect" id="node6" href="group__adc.html#ga6d43ab04f3b55d93bbc00485d3969cf3" title="ADC &#45;&gt; SPI transfer. " alt="" coords="344,23,455,49"/><area shape="rect" id="node5" href="serial__debug_8c.html#acee6fd3c87dfa3cbc8e42b38e99a7e3f" title="debug_write" alt="" coords="597,73,687,100"/><area shape="rect" id="node7" href="group__adc.html#gaaf6b62879373886eb3aaf756134988c0" title="SPI assert. " alt="" coords="587,23,697,49"/><area shape="rect" id="node9" href="group__timer.html#gab5d8b61d2fe766cca70a9eead16e3f76" title="compare timer count to programmed value " alt="" coords="319,124,480,151"/><area shape="rect" id="node11" href="group__teds__management.html#gaed0c252bb875f1f3f5c54d0204811ff7" title="Activate TEDS port as input and enable pull&#45;up. " alt="" coords="863,140,934,167"/><area shape="rect" id="node13" href="group__teds__management.html#ga5be7a41c29d2e5351f4681ce183f9b89" title="Read the ROM section of TEDS memory. " alt="" coords="338,241,461,268"/><area shape="rect" id="node21" href="group__teds__management.html#ga6ea4ed867cd5b7c0b17676b8c455a667" title="Read TEDS memory The sequence is: " alt="" coords="333,317,466,344"/><area shape="rect" id="node12" href="group__teds__management.html#ga141e48c059fcfc2c1da1f64d381d9a2c" title="teds_port_passive_input" alt="" coords="1271,153,1432,180"/><area shape="rect" id="node14" href="group__teds__management.html#ga0f2061f949d8d803b6746cbcfdd560f1" title="Initiate a teds reset and detect cycle. Return !0 if detect pulse received. Teds detect sequence: ..." alt="" coords="1091,204,1181,231"/><area shape="rect" id="node18" href="group__teds__management.html#ga23118e845ba90893a2199e8c734d69a4" title="Write a byte to the TEDS memory. " alt="" coords="842,280,955,307"/><area shape="rect" id="node20" href="group__teds__management.html#gade44d4096cee9968db2e7b005fe34894" title="Read a byte from the TEDS memory. " alt="" coords="587,292,697,319"/><area shape="rect" id="node15" href="group__teds__management.html#ga7a2589d39fb404ba7ce74230f9df81b9" title="teds_port_deassert" alt="" coords="1285,255,1418,281"/><area shape="rect" id="node16" href="long__delay_8h.html#a92da87ed26631edeca29a7888c922b5a" title="long_delay_us" alt="" coords="1299,305,1404,332"/><area shape="rect" id="node17" href="group__teds__management.html#gadd12a3562af693724a7abdc546d92db6" title="teds_port_sample" alt="" coords="1289,204,1414,231"/><area shape="rect" id="node19" href="group__teds__management.html#ga1f0e6b05f6d5811c8083664e16c03a26" title="teds_io" alt="" coords="1104,255,1168,281"/><area shape="rect" id="node24" href="usb__stack_8c.html#aea032e0e591d52fec3b357d95407854f" title="usb_stack_start_device" alt="" coords="320,721,479,748"/><area shape="rect" id="node26" href="group__std__request.html#ga8ba4a2f62a993e3301c6d6bb54e28810" title="Entry point for standard USB requests. " alt="" coords="319,655,479,697"/><area shape="rect" id="node25" href="usb__drv_8c.html#af03d76cb0a6201b1c1de6bc25bf6657e" title="usb_init_device" alt="" coords="587,983,697,1009"/><area shape="rect" id="node27" href="group__std__request.html#gaa7a8a9955cebd26366bb7b511ba7ed89" title="GET DESCRIPTOR. " alt="" coords="544,780,740,807"/><area shape="rect" id="node28" href="group__std__request.html#gaddfd240233bdd859f5929dbefdd8d02e" title="GET CONFIGURATION. " alt="" coords="536,831,748,857"/><area shape="rect" id="node29" href="group__std__request.html#ga2df54f41732b09e7cc4ec9147a9390c6" title="SET ADDRESS Set the Device address received from the host. " alt="" coords="549,881,735,908"/><area shape="rect" id="node30" href="group__std__request.html#gad3c6f0f83ab048aed669ac3482b69d97" title="SET CONFIGURATION Set the Configuration Number received from the host. " alt="" coords="536,932,748,959"/><area shape="rect" id="node32" href="group__std__request.html#ga178fb7e284e4c68dff52770f8daac841" title="CLEAR FEATURE. " alt="" coords="571,445,713,486"/><area shape="rect" id="node33" href="group__std__request.html#gad6c7453e5f5a2fa64477fbf41bfddf01" title="SET FEATURE. " alt="" coords="553,511,731,537"/><area shape="rect" id="node34" href="group__std__request.html#ga6382d9dd5fce1a88451cf60b22825cac" title="GET STATUS. " alt="" coords="555,561,729,588"/><area shape="rect" id="node35" href="group__std__request.html#gadf2bb473164a48407d21feac60e00c34" title="GET INTERFACE. " alt="" coords="548,612,736,639"/><area shape="rect" id="node36" href="group__std__request.html#gae0831cb50420521f252e9f1e76a1e0d1" title="SET INTERFACE Supposed to allow the host to select an alternate setting for the specified interface..." alt="" coords="548,663,736,689"/><area shape="rect" id="node37" href="group__std__request.html#ga0ffc0fa9fbeb7b67d064b83106b88fb9" title="Non&#45;standard (i.e. Class specific) control request processing. " alt="" coords="559,714,725,755"/><area shape="rect" id="node31" href="usb__settings__i_8c.html#a3063b8c2d2e4840445cc0f3d0874ef21" title="usb_stack_user_endpoint_init" alt="" coords="801,932,996,959"/><area shape="rect" id="node38" href="group__hid__request.html#ga739225b6e3928f97d12401fe664ea3dd" title="Class specific (HID) request Get Report. " alt="" coords="829,811,968,853"/><area shape="rect" id="node41" href="group__hid__request.html#ga02478aaf252ce84ec684796ae431a580" title="Class specific (HID) request Set Report. " alt="" coords="829,615,968,657"/><area shape="rect" id="node47" href="hid__handler_8c.html#a93f198bcb95de3f114386e5a0d7f7ded" title="process_user_set_configuration\l_request" alt="" coords="796,681,1001,722"/><area shape="rect" id="node48" href="hid__handler_8c.html#a9fd04676b88aa674c58b119d2c9f16a7" title="process_user_get_interface\l_request" alt="" coords="808,746,989,787"/><area shape="rect" id="node39" href="group__hid__request.html#ga227dced4ac81bf1dff961d423726db2b" title="These are the HID report ID&#39;s with the TEDS memory data. " alt="" coords="1059,843,1213,885"/><area shape="rect" id="node40" href="group__hid__request.html#ga7ca0311fa576160231c1bd68176ca546" title="TEDS output report. " alt="" coords="1057,778,1215,819"/><area shape="rect" id="node42" href="group__hid__request.html#ga2d42be6b14b561b72e38163dc7306527" title="Reset TEDS. " alt="" coords="1062,623,1210,649"/><area shape="rect" id="node45" href="group__hid__request.html#gae7ea0f2cae0f1b156551a78beabe9a6f" title="Write 32 byte pages to TEDS memory one page at a time. " alt="" coords="1059,674,1213,715"/><area shape="rect" id="node46" href="group__hid__request.html#ga967d881d776cf375178daff0a68da59e" title="set_report_REPORT_OUT\l_CMD_DEVICE_RESET" alt="" coords="1049,557,1223,598"/><area shape="rect" id="node43" href="group__std__request.html#ga69cf12f38f3d820953a82f74c8860928" title="Control write transfer. " alt="" coords="1271,622,1431,663"/><area shape="rect" id="node44" href="group__std__request.html#ga83fea9c6170df897ef1b17933a594038" title="Acks a control write transfer. " alt="" coords="1273,557,1429,598"/><area shape="rect" id="node50" href="group__hid.html#gaed31cd92d58e3a8cf0cccab3f9431654" title="service_hid_send_samples\l_report" alt="" coords="311,773,488,814"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Sep 8 2016 18:42:51 for USB Load Cell Interface by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
